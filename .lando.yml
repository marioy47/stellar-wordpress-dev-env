name: stellar
recipe: wordpress
config:
  via: nginx
  webroot: www
  database: mariadb
  xdebug: true

services:

  # Install WordPress
  appserver:
    run:
      - /app/lando/wordpress-install.sh
    overrides:
      volumes:
        - ./plugins:/app/www/wp-content/plugins
        - ./themes:/app/www/wp-content/themes

  # Add PhpMyAdmin in pma.stellar.lndo.site
  pma:
    ssl: true
    type: phpmyadmin

  # Add MailCatcher in mail.stellar.lndo.site
  mailhog:
    ssl: true
    type: mailhog
    hogfrom:
      - appserver

  # Add a Cache database
  redis:
    type: redis
    portforward: false

proxy:

  # Enable Widlcards for multisite to work
  appserver_nginx:
    - "*.stellar.lndo.site"
    - stellar.lndo.site

  pma:
    - stellar-pma.lndo.site

  mailhog:
    - stellar-mail.lndo.site

tooling:

  # Change the wp command to account for the new webroot
  wp:
    service: appserver
    cmd: wp --path=/app/www
